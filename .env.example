# =============================================================================
# TASI AI Platform (Ra'd AI) - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values.
#
# Legend:
#   [REQUIRED]  - Must be set for the app to start
#   [REQUIRED*] - Required only in specific contexts (see description)
#   [optional]  - Has a sensible default; override if needed
#
# Run `python scripts/validate_config.py` to check your configuration.

# ---------------------------------------------------------------------------
# Environment (controls production safety checks)
# ---------------------------------------------------------------------------
# Values: development (default), staging, production
# In production, AUTH_JWT_SECRET is required and stricter validation applies.
# [optional]
ENVIRONMENT=development

# ---------------------------------------------------------------------------
# LLM Provider - Google Gemini (active)
# ---------------------------------------------------------------------------
# [REQUIRED] Gemini API key from https://aistudio.google.com/apikey
GEMINI_API_KEY=your-gemini-api-key-here
# [optional] Gemini model name
GEMINI_MODEL=gemini-2.5-flash

# ---------------------------------------------------------------------------
# LLM Provider - Anthropic (legacy, kept for backward compatibility)
# ---------------------------------------------------------------------------
# [optional] Used only if GEMINI_API_KEY is not set
ANTHROPIC_API_KEY=
# [optional] Overrides ANTHROPIC_API_KEY if set
LLM_API_KEY=
# [optional] LLM model identifier
LLM_MODEL=gemini-2.5-flash
# [optional] Maximum tool call iterations per query
LLM_MAX_TOOL_ITERATIONS=10

# ---------------------------------------------------------------------------
# Database Settings (prefix: DB_)
# ---------------------------------------------------------------------------
# [optional] Backend: "sqlite" (default) or "postgres"
DB_BACKEND=sqlite
# [optional] SQLite: path relative to project root (or absolute)
DB_SQLITE_PATH=saudi_stocks.db

# ---------------------------------------------------------------------------
# PostgreSQL Settings (used when DB_BACKEND=postgres)
# Both DB_PG_* and POSTGRES_* naming conventions are accepted.
# DB_PG_* takes priority if both are set. POSTGRES_* is Docker-compatible.
# ---------------------------------------------------------------------------
# [REQUIRED*] Required when DB_BACKEND=postgres
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=tasi_platform
POSTGRES_USER=tasi_user
# IMPORTANT: Use a strong password in production (required by docker-compose)
POSTGRES_PASSWORD=changeme

# ---------------------------------------------------------------------------
# Server Settings (prefix: SERVER_)
# ---------------------------------------------------------------------------
# [optional] Server bind address
SERVER_HOST=0.0.0.0
# [optional] Server port
SERVER_PORT=8084
# [optional] Enable debug mode (true = dev logging, false = JSON logging)
SERVER_DEBUG=false

# ---------------------------------------------------------------------------
# Authentication Settings (prefix: AUTH_)
# ---------------------------------------------------------------------------
# [REQUIRED*] REQUIRED in production. In development, a random secret is
# generated on each startup (sessions lost on restart).
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
AUTH_JWT_SECRET=change-me-to-a-stable-secret
# [optional] JWT signing algorithm
AUTH_JWT_ALGORITHM=HS256
# [optional] Access token lifetime in minutes
AUTH_ACCESS_TOKEN_EXPIRE_MINUTES=30
# [optional] Refresh token lifetime in days
AUTH_REFRESH_TOKEN_EXPIRE_DAYS=7

# ---------------------------------------------------------------------------
# Connection Pool Settings (PostgreSQL only, prefix: PG_POOL_)
# ---------------------------------------------------------------------------
# [optional] Minimum pool connections
PG_POOL_MIN=2
# [optional] Maximum pool connections
PG_POOL_MAX=10

# ---------------------------------------------------------------------------
# Redis / Cache Settings
# ---------------------------------------------------------------------------
# [optional] Redis connection URL
REDIS_URL=redis://localhost:6379/0
# [optional] Redis password (leave empty for development)
REDIS_PASSWORD=
# [optional] Enable caching
CACHE_ENABLED=false
# [optional] Default cache TTL in seconds
CACHE_DEFAULT_TTL=300

# ---------------------------------------------------------------------------
# Middleware Settings (prefix: MW_)
# ---------------------------------------------------------------------------
# [optional] Comma-separated allowed CORS origins
# In production, add your deployment domain, e.g.:
# MW_CORS_ORIGINS=http://localhost:3000,http://localhost:8084,https://raid-ai-app-production.up.railway.app
MW_CORS_ORIGINS=http://localhost:3000,http://localhost:8084
# [optional] Rate limit: max requests per minute per IP
MW_RATE_LIMIT_PER_MINUTE=60
# [optional] Paths to skip in request logging
MW_LOG_SKIP_PATHS=/health,/favicon.ico

# ---------------------------------------------------------------------------
# Logging
# ---------------------------------------------------------------------------
# [optional] Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ---------------------------------------------------------------------------
# pgAdmin (optional, only with: docker compose --profile tools up)
# ---------------------------------------------------------------------------
# [optional] pgAdmin login email
PGADMIN_DEFAULT_EMAIL=admin@tasi.local
# [REQUIRED*] Required when using pgAdmin profile
PGADMIN_DEFAULT_PASSWORD=

# ---------------------------------------------------------------------------
# Ingestion Pipeline Settings
# ---------------------------------------------------------------------------
# [optional] Batch size for processing tickers
INGESTION_BATCH_SIZE=10
# [optional] Seconds to sleep between batches for rate limiting
INGESTION_RATE_LIMIT_SECONDS=2
