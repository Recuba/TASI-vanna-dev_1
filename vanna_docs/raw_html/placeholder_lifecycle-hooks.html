<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="theme-color" content="#15a8a8" />

		<link rel="icon" type="image/x-icon" href="/favicon.ico" sizes="32x32" />
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
		<link rel="icon" type="image/svg+xml" href="/vanna.svg" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
		<link rel="manifest" href="/manifest.json" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet" />
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-1YZ053XQJ4"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-1YZ053XQJ4');

		function gtag_report_conversion() {
			console.log('gtag');
		gtag('event', 'conversion', {
			'send_to': 'AW-1047571796/EttBCO-3lrgYENTawvMD'
		});
		}
		</script>
		
		<link href="../../_app/immutable/assets/0.zksLnzhI.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/GitHubStars.YEdjEA4A.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/2.xnTvn9Bk.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/32.B7BcHECC.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/style.C5WwWho8.css" rel="stylesheet"><!--[--><link rel="icon" href="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20height='100%25'%20stroke-miterlimit='10'%20style='fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;'%20version='1.1'%20viewBox='0%200%201024%201024'%20width='100%25'%20xml:space='preserve'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:vectornator='http://vectornator.io'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3clinearGradient%20gradientTransform='matrix(1.09331%200%200%201.09331%20-47.1838%20-88.8946)'%20gradientUnits='userSpaceOnUse'%20id='LinearGradient'%20x1='237.82'%20x2='785.097'%20y1='549.609'%20y2='549.609'%3e%3cstop%20offset='0'%20stop-color='%23009efd'/%3e%3cstop%20offset='1'%20stop-color='%232af598'/%3e%3c/linearGradient%3e%3c/defs%3e%3cg%20id='Layer-1'%3e%3cg%20opacity='1'%3e%3cpath%20d='M212.828%20215.239C213.095%20281.169%20213.629%20413.028%20213.629%20413.028C213.629%20413.028%20511.51%20808.257%20513.993%20809.681C612.915%20677.809%20810.759%20414.065%20810.759%20414.065C810.759%20414.065%20811.034%20280.901%20811.172%20214.319C662.105%20362.973%20662.105%20362.973%20513.038%20511.627C362.933%20363.433%20362.933%20363.433%20212.828%20215.239Z'%20fill='url(%23LinearGradient)'%20fill-rule='nonzero'%20opacity='1'%20stroke='none'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"/> <link rel="canonical" href="https://vanna.ai/docs/placeholder/lifecycle-hooks"/>  <meta name="description" content="Build AI agents that ship to production. User-scoped execution, rich UI components, and quota management built-in."/> <meta name="robots" content="index, follow, max-image-preview:large"/> <meta name="author" content="Vanna AI Team"/> <meta name="googlebot" content="index, follow"/>  <meta property="og:site_name" content="Vanna AI"/> <meta property="og:description" content="Build AI agents that ship to production. User-scoped execution, rich UI components, and quota management built-in."/> <meta property="og:image:width" content="1200"/> <meta property="og:image:height" content="630"/> <meta property="og:url" content="https://vanna.ai/docs/placeholder/lifecycle-hooks"/> <meta property="og:type" content="website"/> <meta property="og:locale" content="en_US"/> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@vannadotai"/> <meta name="twitter:creator" content="@vannadotai"/> <meta name="twitter:description" content="Build AI agents that ship to production. User-scoped execution, rich UI components, and quota management built-in."/> <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","name":"Vanna AI","url":"https://vanna.ai","logo":"https://vanna.ai/vanna.svg","sameAs":["https://github.com/vanna-ai/vanna","https://twitter.com/vannadotai","https://linkedin.com/company/vanna-ai"],"description":"Build AI agents that ship to production. User-scoped execution, rich UI components, and quota management built-in."}</script><!----> <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","url":"https://vanna.ai","name":"Vanna AI","description":"Build AI agents that ship to production. User-scoped execution, rich UI components, and quota management built-in.","potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://vanna.ai/docs?q={search_term_string}"},"query-input":"required name=search_term_string"}}</script><!----><!--]--><!--[--><meta property="og:image" content="https://vanna.ai/og/architecture.png"/> <meta name="twitter:image" content="https://vanna.ai/og/architecture.png"/><!--]--><!--[--><!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"https://vanna.ai/docs"},{"@type":"ListItem","position":2,"name":"Placeholder","item":"https://vanna.ai/docs/placeholder"},{"@type":"ListItem","position":3,"name":"Lifecycle Hooks","item":"https://vanna.ai/docs/placeholder/lifecycle-hooks"}]}</script><!----><!--]--><title>Lifecycle Hooks - Vanna AI Docs</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!--[--><!----><div class="relative min-h-screen bg-gradient-to-b from-vanna-cream via-white to-vanna-cream"><div class="pointer-events-none absolute inset-0 overflow-hidden"><div class="absolute inset-0 bg-[radial-gradient(circle_at_top_left,rgba(21,168,168,0.12),transparent_60%),radial-gradient(circle_at_bottom_right,rgba(254,93,38,0.08),transparent_65%)]"></div> <div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, rgba(2, 61, 96, 0.3) 1px, transparent 0); background-size: 32px 32px;"></div> <div class="absolute inset-0 bg-grid-vanna-navy opacity-20" style="background-image: linear-gradient(rgba(2, 61, 96, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(2, 61, 96, 0.1) 1px, transparent 1px); background-size: 100px 100px;"></div> <div class="absolute left-[10%] top-[-12%] h-[26rem] w-[26rem] rounded-full bg-gradient-to-br from-vanna-teal/40 via-vanna-cream to-transparent blur-[180px]"></div> <div class="absolute right-[-12%] top-[18%] h-[30rem] w-[30rem] rounded-full bg-gradient-to-br from-vanna-orange/30 via-vanna-magenta/20 to-transparent blur-[220px]"></div></div> <nav class="sticky top-0 z-50 h-16 bg-vanna-cream/95 backdrop-blur border-b border-vanna-teal/30"><div class="h-full mx-auto flex items-center justify-between px-4 lg:px-8"><div class="flex items-center gap-4"><button class="lg:hidden p-2 text-vanna-navy hover:text-vanna-teal transition-colors" aria-label="Toggle sidebar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button> <a href="/" class="flex items-center gap-2 text-sm font-medium text-vanna-navy hover:text-vanna-teal transition-colors font-sans"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> <span class="hidden sm:inline">Back to Vanna.ai</span> <span class="sm:hidden">Back</span></a></div> <span class="hidden md:block text-lg font-semibold text-vanna-navy font-serif">Documentation</span> <!--[--><a href="https://app.vanna.ai" class="inline-flex items-center justify-center font-semibold transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 font-serif bg-vanna-teal text-white shadow-[0_12px_30px_rgba(21,168,168,0.35)] hover:shadow-[0_16px_40px_rgba(21,168,168,0.45)] hover:translate-y-[-1px] focus-visible:ring-vanna-teal focus-visible:ring-offset-white h-9 px-3 text-sm rounded-full"><!---->Get Started Free<!----></a><!--]--><!----></div></nav><!----> <div class="flex relative"><aside class=" -translate-x-full lg:translate-x-0 fixed lg:sticky top-0 lg:top-16 left-0 h-screen lg:h-[calc(100vh-4rem)] w-72 bg-vanna-cream/90 backdrop-blur-sm border-r border-vanna-teal/30 transition-transform duration-300 ease-in-out z-40 overflow-y-auto "><nav class="p-6"><div class="mb-8"><a href="/" class="flex items-center space-x-3 group"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="100%" stroke-miterlimit="10" style="fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;" version="1.1" viewBox="0 0 1024 1024" width="100%" xml:space="preserve" class="h-9 w-9"><defs><linearGradient gradientTransform="matrix(1.09331 0 0 1.09331 -47.1838 -88.8946)" gradientUnits="userSpaceOnUse" id="VannaLogoGradient" x1="237.82" x2="785.097" y1="549.609" y2="549.609"><stop offset="0" stop-color="#009efd"></stop><stop offset="1" stop-color="#2af598"></stop></linearGradient></defs><g id="Layer-1"><!--[--><circle cx="512" cy="512" r="480" fill="#023d60" opacity="1"></circle><!--]--><g opacity="1"><path d="M212.828 215.239C213.095 281.169 213.629 413.028 213.629 413.028C213.629 413.028 511.51 808.257 513.993 809.681C612.915 677.809 810.759 414.065 810.759 414.065C810.759 414.065 811.034 280.901 811.172 214.319C662.105 362.973 662.105 362.973 513.038 511.627C362.933 363.433 362.933 363.433 212.828 215.239Z" fill="url(#VannaLogoGradient)" fill-rule="nonzero" opacity="1" stroke="none"></path></g></g></svg><!----> <div><div class="text-xl font-semibold text-vanna-navy group-hover:text-vanna-teal transition-colors font-serif">Vanna AI</div> <div class="text-xs text-slate-500">Documentation</div></div></a></div> <div class="space-y-1"><!--[--><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üöÄ</span><!--]--> <span class="leading-tight break-words">Getting Started</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[--><ul class="mt-1 space-y-0.5 pl-2"><!--[--><li><a href="/docs" class="group block px-3 py-2 text-sm rounded-lg transition-all text-slate-700 hover:bg-vanna-teal/10 hover:text-vanna-navy" title="What is Vanna 2.0?"><div class="flex items-start gap-2"><div class="flex items-start min-w-0 flex-1"><!--[!--><!--]--> <span class="leading-tight break-words">What is Vanna 2.0?</span></div> <!--[!--><!--]--></div></a></li><li><a href="/docs/quick-start" class="group block px-3 py-2 text-sm rounded-lg transition-all text-slate-700 hover:bg-vanna-teal/10 hover:text-vanna-navy" title="Quickstart with Sample Database"><div class="flex items-start gap-2"><div class="flex items-start min-w-0 flex-1"><!--[!--><!--]--> <span class="leading-tight break-words">Quickstart with Sample Database</span></div> <!--[--><span class="flex-shrink-0 text-[10px] px-1.5 py-0.5 rounded bg-vanna-teal/20 text-vanna-navy font-medium whitespace-nowrap leading-tight">30 sec</span><!--]--></div></a></li><li><a href="/docs/configure" class="group block px-3 py-2 text-sm rounded-lg transition-all text-slate-700 hover:bg-vanna-teal/10 hover:text-vanna-navy" title="Connect to Your Own Database"><div class="flex items-start gap-2"><div class="flex items-start min-w-0 flex-1"><!--[!--><!--]--> <span class="leading-tight break-words">Connect to Your Own Database</span></div> <!--[--><span class="flex-shrink-0 text-[10px] px-1.5 py-0.5 rounded bg-vanna-teal/20 text-vanna-navy font-medium whitespace-nowrap leading-tight">5 min</span><!--]--></div></a></li><li><a href="/docs/migration" class="group block px-3 py-2 text-sm rounded-lg transition-all text-slate-700 hover:bg-vanna-teal/10 hover:text-vanna-navy" title="Migration from 0.x"><div class="flex items-start gap-2"><div class="flex items-start min-w-0 flex-1"><!--[!--><!--]--> <span class="leading-tight break-words">Migration from 0.x</span></div> <!--[!--><!--]--></div></a></li><!--]--></ul><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üîê</span><!--]--> <span class="leading-tight break-words">Authentication &amp; Permissions</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üé®</span><!--]--> <span class="leading-tight break-words">Web UI</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üö¢</span><!--]--> <span class="leading-tight break-words">Deployment</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üîß</span><!--]--> <span class="leading-tight break-words">Customization</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üéì</span><!--]--> <span class="leading-tight break-words">Advanced</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">üîç</span><!--]--> <span class="leading-tight break-words">API Reference</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><div class="mb-2"><button class="w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-slate-600 uppercase tracking-wider hover:bg-vanna-teal/5 rounded-lg transition-colors group"><span class="flex items-center gap-2 group-hover:text-vanna-navy transition-colors min-w-0 flex-1 text-left"><!--[--><span class="text-base flex-shrink-0">‚ùì</span><!--]--> <span class="leading-tight break-words">Help &amp; Support</span></span> <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <!--[!--><!--]--></div><!--]--></div> <div class="mt-8 px-3"><a href="https://github.com/vanna-ai/vanna" target="_blank" rel="noopener noreferrer" class="inline-flex items-center space-x-2 px-4 py-2 bg-white border border-slate-200 rounded-lg hover:border-slate-300 hover:shadow-md transition-all group svelte-qyb6s4"><svg class="w-5 h-5 text-slate-700 group-hover:text-slate-900 transition-colors" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg> <span class="text-sm font-medium text-slate-700 group-hover:text-slate-900 transition-colors">Star</span> <div class="flex items-center space-x-1 px-2 py-0.5 bg-slate-100 rounded-md min-w-[3rem] justify-center"><!--[--><div class="w-4 h-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"></div><!--]--></div></a><!----></div> <div class="mt-6 pt-6 border-t border-slate-200"><div class="space-y-2"><a href="/" class="flex items-center space-x-2 px-3 py-2 text-sm text-slate-600 hover:text-vanna-navy hover:bg-vanna-teal/10 rounded-lg transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg> <span>Back to Home</span></a></div></div></nav><!----></aside> <!--[!--><!--]--> <div class="flex-1 flex relative"><main class="flex-1 px-4 py-8 lg:px-12 lg:py-12 max-w-4xl relative"><!--[--><nav aria-label="Breadcrumb" class="flex items-center space-x-2 text-sm mb-6"><!--[--><!--[!--><!--]--> <!--[!--><a href="/docs" class="text-slate-600 hover:text-blue-600 transition-colors">Docs</a><!--]--><!--[--><svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><!--]--> <!--[!--><a href="/docs/placeholder" class="text-slate-600 hover:text-blue-600 transition-colors">Placeholder</a><!--]--><!--[--><svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><!--]--> <!--[--><span class="font-medium text-slate-900">Lifecycle Hooks</span><!--]--><!--]--></nav><!--]--> <!--[!--><!--]--> <article class="prose prose-slate max-w-none"><!--[--><!----><div class="mb-8 rounded-lg border-2 border-vanna-magenta/40 bg-gradient-to-br from-vanna-magenta/10 via-vanna-orange/5 to-vanna-cream/40 p-6 shadow-[0_4px_12px_rgba(191,19,99,0.2)]"><div class="flex items-start space-x-3"><div class="flex-shrink-0 mt-0.5"><svg class="h-6 w-6 text-vanna-magenta" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg></div> <div class="flex-1"><h3 class="text-base font-semibold text-vanna-navy mb-2">AI-Generated Placeholder Documentation</h3> <p class="text-sm text-slate-700 mb-3">This documentation page has been automatically generated by a Large Language Model (LLM) and serves as placeholder content. The information provided here may be incomplete, inaccurate, or subject to change.</p> <p class="text-sm text-slate-700">For accurate and complete information, please refer to the <a href="https://github.com/vanna-ai/vanna" target="_blank" rel="noopener noreferrer" class="text-vanna-teal hover:text-vanna-navy font-medium underline">Vanna source code on GitHub</a>.</p></div></div></div> <!----><h1 id="lifecycle-hooks"><a aria-hidden="true" tabindex="-1" href="#lifecycle-hooks"><span class="icon icon-link"></span></a>Lifecycle Hooks</h1> <p>Lifecycle hooks allow you to intercept and customize agent behavior at key points in the execution flow.</p> <div class="flow-container svelte-ou7rkg"><div class="legend svelte-ou7rkg"><div class="legend-item svelte-ou7rkg"><div class="legend-color before-msg svelte-ou7rkg"></div> <span>before_message - Execute in order (1‚Üí2‚Üí3)</span></div> <div class="legend-item svelte-ou7rkg"><div class="legend-color before-tool svelte-ou7rkg"></div> <span>before_tool - Execute in order (1‚Üí2‚Üí3)</span></div> <div class="legend-item svelte-ou7rkg"><div class="legend-color after-tool svelte-ou7rkg"></div> <span>after_tool - Execute in reverse (3‚Üí2‚Üí1)</span></div> <div class="legend-item svelte-ou7rkg"><div class="legend-color after-msg svelte-ou7rkg"></div> <span>after_message - Execute in reverse (3‚Üí2‚Üí1)</span></div></div> <!--[!--><div class="flow-wrapper loading svelte-ou7rkg">Loading diagram...</div><!--]--></div><!----> <h2 id="lifecyclehook-interface"><a aria-hidden="true" tabindex="-1" href="#lifecyclehook-interface"><span class="icon icon-link"></span></a>LifecycleHook Interface</h2> <p>All lifecycle hooks extend the <code>LifecycleHook</code> base class:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lifecycle <span class="token keyword">import</span> LifecycleHook
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>user <span class="token keyword">import</span> User
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>tool <span class="token keyword">import</span> Tool<span class="token punctuation">,</span> ToolContext<span class="token punctuation">,</span> ToolResult

<span class="token keyword">class</span> <span class="token class-name">LifecycleHook</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Called before processing a user message"""</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>  <span class="token comment"># Return modified message or None</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Called after message processing completes"""</span>
        <span class="token keyword">pass</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Called before tool execution"""</span>
        <span class="token keyword">pass</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> ToolResult<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>ToolResult<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Called after tool execution"""</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>  <span class="token comment"># Return modified result or None</span></code><!----></pre> <h2 id="registering-hooks"><a aria-hidden="true" tabindex="-1" href="#registering-hooks"><span class="icon icon-link"></span></a>Registering Hooks</h2> <p>Add hooks when creating your agent:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> vanna <span class="token keyword">import</span> Agent

agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>
    llm_service<span class="token operator">=</span>llm<span class="token punctuation">,</span>
    sql_runner<span class="token operator">=</span>sql_runner<span class="token punctuation">,</span>
    lifecycle_hooks<span class="token operator">=</span><span class="token punctuation">[</span>
        LoggingHook<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        QuotaCheckHook<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        MetricsHook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span></code><!----></pre> <h2 id="built-in-hooks"><a aria-hidden="true" tabindex="-1" href="#built-in-hooks"><span class="icon icon-link"></span></a>Built-in Hooks</h2> <h3 id="logginghook"><a aria-hidden="true" tabindex="-1" href="#logginghook"><span class="icon icon-link"></span></a>LoggingHook</h3> <p>Basic logging of agent activity:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lifecycle <span class="token keyword">import</span> LoggingHook

hook <span class="token operator">=</span> LoggingHook<span class="token punctuation">(</span>logger<span class="token operator">=</span>my_logger<span class="token punctuation">)</span></code><!----></pre> <h2 id="custom-hook-examples"><a aria-hidden="true" tabindex="-1" href="#custom-hook-examples"><span class="icon icon-link"></span></a>Custom Hook Examples</h2> <h3 id="example-1-logging-hook"><a aria-hidden="true" tabindex="-1" href="#example-1-logging-hook"><span class="icon icon-link"></span></a>Example 1: Logging Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">import</span> logging
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lifecycle <span class="token keyword">import</span> LifecycleHook

<span class="token keyword">class</span> <span class="token class-name">DetailedLoggingHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"User </span><span class="token interpolation"><span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">&#125;</span></span><span class="token string">) sent message"</span></span><span class="token punctuation">,</span>
            extra<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"message_length"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>  <span class="token comment"># Don't modify message</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Message processing complete"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"Executing tool: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tool<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            extra<span class="token operator">=</span><span class="token punctuation">&#123;</span>
                <span class="token string">"user_id"</span><span class="token punctuation">:</span> context<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
                <span class="token string">"conversation_id"</span><span class="token punctuation">:</span> context<span class="token punctuation">.</span>conversation_id
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> ToolResult<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"Tool execution </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'succeeded'</span> <span class="token keyword">if</span> result<span class="token punctuation">.</span>success <span class="token keyword">else</span> <span class="token string">'failed'</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            extra<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"has_ui_component"</span><span class="token punctuation">:</span> result<span class="token punctuation">.</span>ui_component <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>  <span class="token comment"># Don't modify result</span></code><!----></pre> <h3 id="example-2-usage-quota-hook"><a aria-hidden="true" tabindex="-1" href="#example-2-usage-quota-hook"><span class="icon icon-link"></span></a>Example 2: Usage Quota Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lifecycle <span class="token keyword">import</span> LifecycleHook
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>errors <span class="token keyword">import</span> AgentError

<span class="token keyword">class</span> <span class="token class-name">QuotaCheckHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> quota_service<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>quota_service <span class="token operator">=</span> quota_service
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># Check if user has remaining quota</span>
        remaining <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>quota_service<span class="token punctuation">.</span>get_remaining<span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> remaining <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> AgentError<span class="token punctuation">(</span>
                <span class="token string">"Usage quota exceeded. Please upgrade your plan."</span>
            <span class="token punctuation">)</span>
        
        <span class="token comment"># Decrement quota</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>quota_service<span class="token punctuation">.</span>decrement<span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># Track tool usage for billing</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>quota_service<span class="token punctuation">.</span>record_tool_usage<span class="token punctuation">(</span>
            user_id<span class="token operator">=</span>context<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            tool_name<span class="token operator">=</span>tool<span class="token punctuation">.</span>name
        <span class="token punctuation">)</span></code><!----></pre> <h3 id="example-3-content-moderation-hook"><a aria-hidden="true" tabindex="-1" href="#example-3-content-moderation-hook"><span class="icon icon-link"></span></a>Example 3: Content Moderation Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ModerationHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> moderation_api<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>moderation_api <span class="token operator">=</span> moderation_api
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_message</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token comment"># Check message for inappropriate content</span>
        result <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>moderation_api<span class="token punctuation">.</span>check<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> result<span class="token punctuation">.</span>flagged<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> AgentError<span class="token punctuation">(</span>
                <span class="token string">"Message contains inappropriate content"</span>
            <span class="token punctuation">)</span>
        
        <span class="token comment"># Optionally sanitize the message</span>
        <span class="token keyword">if</span> result<span class="token punctuation">.</span>needs_sanitization<span class="token punctuation">:</span>
            <span class="token keyword">return</span> result<span class="token punctuation">.</span>sanitized_text
        
        <span class="token keyword">return</span> <span class="token boolean">None</span>  <span class="token comment"># No changes needed</span></code><!----></pre> <h3 id="example-4-performance-monitoring-hook"><a aria-hidden="true" tabindex="-1" href="#example-4-performance-monitoring-hook"><span class="icon icon-link"></span></a>Example 4: Performance Monitoring Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lifecycle <span class="token keyword">import</span> LifecycleHook

<span class="token keyword">class</span> <span class="token class-name">PerformanceHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> metrics_service<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>metrics <span class="token operator">=</span> metrics_service
        self<span class="token punctuation">.</span>start_times <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># Record start time</span>
        key <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>context<span class="token punctuation">.</span>request_id<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tool<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        self<span class="token punctuation">.</span>start_times<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> ToolResult<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># Calculate and record duration</span>
        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">'metadata'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token string">'request_id'</span> <span class="token keyword">in</span> result<span class="token punctuation">.</span>metadata<span class="token punctuation">:</span>
            key <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'request_id'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'tool_name'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
            
            <span class="token keyword">if</span> key <span class="token keyword">in</span> self<span class="token punctuation">.</span>start_times<span class="token punctuation">:</span>
                duration <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>start_times<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
                
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>record_duration<span class="token punctuation">(</span>
                    tool_name<span class="token operator">=</span>result<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'tool_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    duration_ms<span class="token operator">=</span>duration <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
                    success<span class="token operator">=</span>result<span class="token punctuation">.</span>success
                <span class="token punctuation">)</span>
                
                <span class="token keyword">del</span> self<span class="token punctuation">.</span>start_times<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        
        <span class="token keyword">return</span> <span class="token boolean">None</span></code><!----></pre> <h3 id="example-5-result-transformation-hook"><a aria-hidden="true" tabindex="-1" href="#example-5-result-transformation-hook"><span class="icon icon-link"></span></a>Example 5: Result Transformation Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ResultEnhancementHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> ToolResult<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>ToolResult<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token comment"># Add metadata to all successful results</span>
        <span class="token keyword">if</span> result<span class="token punctuation">.</span>success<span class="token punctuation">:</span>
            <span class="token keyword">if</span> result<span class="token punctuation">.</span>metadata <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                result<span class="token punctuation">.</span>metadata <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
            
            result<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'processed_at'</span><span class="token punctuation">]</span> <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
            result<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'enhanced_by_hook'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
            
            <span class="token comment"># Modify the result for LLM</span>
            result<span class="token punctuation">.</span>result_for_llm <span class="token operator">+=</span> <span class="token string">"&#92;n&#92;n[Result verified and enhanced]"</span>
        
        <span class="token keyword">return</span> result  <span class="token comment"># Return modified result</span></code><!----></pre> <h3 id="example-6-caching-hook"><a aria-hidden="true" tabindex="-1" href="#example-6-caching-hook"><span class="icon icon-link"></span></a>Example 6: Caching Hook</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> json

<span class="token keyword">class</span> <span class="token class-name">CachingHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cache_backend<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>cache <span class="token operator">=</span> cache_backend
        self<span class="token punctuation">.</span>pending_calls <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># Generate cache key from tool name + args</span>
        cache_key <span class="token operator">=</span> self<span class="token punctuation">.</span>_generate_cache_key<span class="token punctuation">(</span>tool<span class="token punctuation">.</span>name<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
        
        <span class="token comment"># Check if we have a cached result</span>
        cached_result <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cache_key<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> cached_result<span class="token punctuation">:</span>
            <span class="token comment"># Store for retrieval in after_tool</span>
            self<span class="token punctuation">.</span>pending_calls<span class="token punctuation">[</span>context<span class="token punctuation">.</span>request_id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token string">'cached'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token string">'result'</span><span class="token punctuation">:</span> cached_result
            <span class="token punctuation">&#125;</span>
            <span class="token comment"># We can't short-circuit here, but can in after_tool</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>pending_calls<span class="token punctuation">[</span>context<span class="token punctuation">.</span>request_id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token string">'cached'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
                <span class="token string">'cache_key'</span><span class="token punctuation">:</span> cache_key
            <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">after_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">:</span> ToolResult<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>ToolResult<span class="token punctuation">]</span><span class="token punctuation">:</span>
        request_id <span class="token operator">=</span> result<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'request_id'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> result<span class="token punctuation">.</span>metadata <span class="token keyword">else</span> <span class="token boolean">None</span>
        
        <span class="token keyword">if</span> request_id <span class="token keyword">in</span> self<span class="token punctuation">.</span>pending_calls<span class="token punctuation">:</span>
            pending <span class="token operator">=</span> self<span class="token punctuation">.</span>pending_calls<span class="token punctuation">[</span>request_id<span class="token punctuation">]</span>
            
            <span class="token keyword">if</span> pending<span class="token punctuation">[</span><span class="token string">'cached'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token comment"># Return cached result</span>
                <span class="token keyword">return</span> pending<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment"># Cache new result</span>
                <span class="token keyword">if</span> result<span class="token punctuation">.</span>success<span class="token punctuation">:</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>
                        pending<span class="token punctuation">[</span><span class="token string">'cache_key'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        result<span class="token punctuation">,</span>
                        ttl<span class="token operator">=</span><span class="token number">3600</span>  <span class="token comment"># 1 hour</span>
                    <span class="token punctuation">)</span>
            
            <span class="token keyword">del</span> self<span class="token punctuation">.</span>pending_calls<span class="token punctuation">[</span>request_id<span class="token punctuation">]</span>
        
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">_generate_cache_key</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token comment"># Create deterministic cache key</span>
        key_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'tool'</span><span class="token punctuation">:</span> tool_name<span class="token punctuation">,</span>
            <span class="token string">'user_id'</span><span class="token punctuation">:</span> context<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            <span class="token string">'args'</span><span class="token punctuation">:</span> context<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'args'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        key_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>key_data<span class="token punctuation">,</span> sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>key_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span></code><!----></pre> <h2 id="hook-execution-order"><a aria-hidden="true" tabindex="-1" href="#hook-execution-order"><span class="icon icon-link"></span></a>Hook Execution Order</h2> <p>Hooks are executed in the order they‚Äôre registered:</p> <pre class="language-python"><!----><code class="language-python">agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>
    llm_service<span class="token operator">=</span>llm<span class="token punctuation">,</span>
    lifecycle_hooks<span class="token operator">=</span><span class="token punctuation">[</span>
        Hook1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># Runs first</span>
        Hook2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># Runs second</span>
        Hook3<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># Runs third</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span></code><!----></pre> <h2 id="error-handling"><a aria-hidden="true" tabindex="-1" href="#error-handling"><span class="icon icon-link"></span></a>Error Handling</h2> <p>Hooks can raise errors to halt processing:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ValidationHook</span><span class="token punctuation">(</span>LifecycleHook<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">before_tool</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tool<span class="token punctuation">:</span> Tool<span class="token punctuation">,</span> context<span class="token punctuation">:</span> ToolContext<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_valid_request<span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> AgentError<span class="token punctuation">(</span><span class="token string">"Invalid request"</span><span class="token punctuation">)</span></code><!----></pre> <h2 id="best-practices"><a aria-hidden="true" tabindex="-1" href="#best-practices"><span class="icon icon-link"></span></a>Best Practices</h2> <ol><li><strong>Keep hooks focused</strong> - One responsibility per hook</li> <li><strong>Handle errors gracefully</strong> - Don‚Äôt crash the agent</li> <li><strong>Be mindful of performance</strong> - Hooks run on every request</li> <li><strong>Use async properly</strong> - All hooks are async</li> <li><strong>Don‚Äôt modify unless needed</strong> - Return None to pass through unchanged</li> <li><strong>Log hook activity</strong> - For debugging and monitoring</li> <li><strong>Test hooks independently</strong> - Unit test each hook</li></ol> <h2 id="combining-with-other-features"><a aria-hidden="true" tabindex="-1" href="#combining-with-other-features"><span class="icon icon-link"></span></a>Combining with Other Features</h2> <p>Hooks work well with other extensibility points:</p> <pre class="language-python"><!----><code class="language-python">agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>
    llm_service<span class="token operator">=</span>llm<span class="token punctuation">,</span>
    workflow_handler<span class="token operator">=</span>CommandHandler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    lifecycle_hooks<span class="token operator">=</span><span class="token punctuation">[</span>QuotaHook<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LoggingHook<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    llm_middlewares<span class="token operator">=</span><span class="token punctuation">[</span>CachingMiddleware<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    context_enrichers<span class="token operator">=</span><span class="token punctuation">[</span>UserPreferencesEnricher<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    conversation_filters<span class="token operator">=</span><span class="token punctuation">[</span>ContextWindowFilter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span></code><!----></pre> <h2 id="see-also"><a aria-hidden="true" tabindex="-1" href="#see-also"><span class="icon icon-link"></span></a>See Also</h2> <ul><li><a href="/docs/placeholder/workflow-handlers">Workflow Handlers</a> - Intercept messages before LLM processing</li> <li><a href="/docs/placeholder/llm-middlewares">LLM Middlewares</a></li> <li><a href="/docs/placeholder/context-enrichers">Context Enrichers</a></li> <li><a href="/docs/placeholder/observability">Observability</a></li> <li><a href="/docs/placeholder/audit-logging">Audit Logging</a></li></ul><!----><!----><!----><!--]--><!----></article></main> <aside class="hidden xl:block w-64 self-start sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto border-l border-vanna-teal/30 bg-vanna-cream/40 backdrop-blur-sm py-8"><div class="px-6"><!--[!--><!--]--><!----></div></aside></div></div></div><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_16trznd = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.DcOBynbd.js"),
						import("../../_app/immutable/entry/app.-MFgy3Ey.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 4, 32],
							data: [null,null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
